---
title: "Domine a Arte dos Testes com Jest e Snapshots: Um Guia R√°pido e Pr√°tico para Testes de Interface do Usu√°rio"
date: '2023-11-08'
language: pt-BR
tags: ['testes', 'react', 'mobile', 'web', 'javascript']
images: ['/static/blog/tests-with-jest-and-snapshots.webp']
authors: ['andrevieira']
draft: false
layout: PostBanner
summary: "O Jest √© uma ferramenta incrivelmente vers√°til que oferece suporte para diversos tipos de testes, mas hoje, vamos nos concentrar em uma de suas caracter√≠sticas mais poderosas: snapshots."
canonicalUrl: https://andreluizv.dev.br/blog/domine-a-arte-dos-testes-com-jest-e-snapshots-um-guia-r√°pido-e-pr√°tico-para-testes-de-interface-do-usu√°rio
---

# Introdu√ß√£o

Em um mundo em constante evolu√ß√£o de desenvolvimento de software, a garantia da qualidade se tornou uma pedra angular para o sucesso de qualquer projeto. Testar seu c√≥digo de forma eficaz √© fundamental para evitar erros e garantir que as funcionalidades do seu aplicativo funcionem conforme o esperado. E √© nesse contexto que o Jest, uma das bibliotecas de teste mais populares para JavaScript, entra em cena.

O Jest √© uma ferramenta incrivelmente vers√°til que oferece suporte para diversos tipos de testes, mas hoje, vamos nos concentrar em uma de suas caracter√≠sticas mais poderosas: snapshots. Snapshots s√£o uma maneira eficaz de capturar automaticamente o estado de um componente, objeto ou estrutura de dados e compar√°-lo com vers√µes futuras para identificar altera√ß√µes inesperadas. Isso pode ser particularmente √∫til ao testar componentes de interface do usu√°rio, onde pequenas altera√ß√µes podem ter um grande impacto na experi√™ncia do usu√°rio.

Neste post, vamos explorar como utilizar Jest e snapshots para criar testes s√≥lidos, eficientes e de baixa manuten√ß√£o. Voc√™ descobrir√° como implementar testes de snapshots, quando us√°-los e como interpretar os resultados. Al√©m disso, fornecerei dicas e pr√°ticas recomendadas para aprimorar seus testes e garantir que seu c√≥digo esteja livre de regress√µes.

Prepare-se para aprofundar seus conhecimentos em testes de unidade e de interface do usu√°rio enquanto exploramos o fascinante mundo dos testes com Jest e snapshots. Vamos come√ßar!

N√£o se esque√ßa de consultar sempre a documenta√ß√£o oficial para eventuais d√∫vidas ou problemas.

[üîó Jest Snapshot documentaion](https://jestjs.io/docs/snapshot-testing)

Snapshots servem para dar a seguran√ßa de que nenhum elemento, componente ou atributo no HTML em tela foi alterado durante o desenvolvimento. Como o nome sugere, ele funciona como uma ‚Äúfoto‚Äù do c√≥digo para validar se houve alguma altera√ß√£o.

## Preparando os testes
Considere o seguinte componente `src/app/profile/page.tsx`:

``` js
export default function Profile() {
  const [text, setText] = useState("Type something on input to change here");

  return (
    <>
      <div>
        <input type="text" onChange={(event) => setText(event.target.value)} />
        <p>{text}</p>
      </div>
      <div>
        <div>
          <Link href="/">Back to home</Link>
        </div>
      </div>
    </>
  );
}
```

Considere os seguintes testes para este componente no arquivo `src/app/profile/page.spec.tsx`:

``` js
describe("Profile component", () => {
  it("renders input and paragraph elements", () => {
    ...
  });

  it("changes the text when input value changes", () => {
    ...
  });

  it("matches snapshot", () => {
    const { container } = render(<Profile />);
    expect(container).toMatchSnapshot();
  });
});
```

Para realizar a valida√ß√£o do Snapshot √© necess√°ria a utiliza√ß√£o do `toMatchSnapshot` referenciando para a renderiza√ß√£o do componente. Esta refer√™ncia pode ser obtida das seguintes formas:

``` js
it("matches snapshot", () => {
  const { container } = render(<Profile />);
  expect(container).toMatchSnapshot();
});

// OU

it("matches snapshot", () => {
  const { asFragment } = render(<Profile />);
  expect(asFragment()).toMatchSnapshot();
});
```

Ap√≥s configurar os testes, basta rodar com o `yarn test` e os snapshots ser√£o criados em uma pasta `__snapshots__` no local do arquivo de teste em quest√£o, como exemplificado na imagem.

<div align='center'>
    <Image
        src="/static/blog/tests-with-jest-and-snapshots-secondary.webp"
        alt="Estrutura de arquivos em testes com Jest e Snapshots"
        width={600}
        height={550}
    />
</div>

Ap√≥s isso √© poss√≠vel verificar que dentro de `src/app/profile/__**snapshots__**/page.spec.tsx.snap` h√° um c√≥digo semelhante ao componente desenvolvido para posteriores compara√ß√µes ao rodarmos os testes.

## Atualizando os snapshots
Caso haja a real necessidade de altera√ß√£o do componente, ent√£o ser√° necess√°ria a atualiza√ß√£o dos snapshots tamb√©m, pois queremos garantir o m√°ximo de efici√™ncia na renderiza√ß√£o do componente. Para isso utilizamos os seguintes comandos.

``` bash
yarn test -- -u
# OU
yarn test --updateSnapshot
```

## ‚ùó ATEN√á√ÉO

Ao atualizar um snapshot voc√™ est√° informando que a altera√ß√£o feita √© realmente esperada. Cuidado para n√£o atualizar os snapshots com altera√ß√µes indesejadas ou principalmente atualizar os snapshots desnecess√°rios, atualize somente dos arquivos que devem de fato sofrer altera√ß√µes!

# Conclus√£o
Neste breve post sobre testes com Jest e snapshots, voc√™ teve a oportunidade de descobrir uma ferramenta poderosa para melhorar a qualidade do seu c√≥digo. Snapshots, quando usados com sabedoria, podem simplificar e aprimorar significativamente o processo de teste, ajudando a evitar regress√µes indesejadas e aprimorar a experi√™ncia do usu√°rio.

Agora, a bola est√° com voc√™! Experimente o Jest e comece a aplicar snapshots em seu pr√≥prio c√≥digo. Teste, aprenda e aprimore continuamente suas habilidades de teste. √Ä medida que voc√™ se aprofunda nesse mundo fascinante, compartilhe seu conhecimento com seus colegas de trabalho e amigos desenvolvedores.

N√£o se esque√ßa de me seguir para receber mais dicas, truques e insights sobre desenvolvimento de software. Curta este post se voc√™ achou √∫til e, o mais importante, compartilhe-o com seus amigos e colegas que tamb√©m est√£o interessados em aprimorar suas habilidades de teste.

Juntos, podemos construir um ecossistema de desenvolvimento mais robusto e confi√°vel. Obrigado por me acompanhar at√© aqui, at√© a pr√≥xima!